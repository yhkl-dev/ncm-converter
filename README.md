# NCM Converter Extension

A Chrome browser extension that converts NetEase Cloud Music (NCM) files to standard audio formats (MP3, FLAC, etc.).

## Features

- ğŸµ **Multi-Format Support** - Convert to MP3, FLAC, OGG, M4A, WAV and other audio formats
- ğŸ” **Local Decryption** - All decryption operations are performed locally without uploading to any server
- ğŸŒ **Internationalization** - Support for English and Chinese interfaces
- ğŸ“Š **Real-Time Progress** - Display conversion progress percentage
- ğŸ’¾ **Auto Download** - Files are automatically downloaded after conversion
- ğŸ“ **Metadata Extraction** - Preserves music title, artist, album and other information

## Technology Stack

- **Framework**: Plasmo (React + TypeScript)
- **Cryptography**: crypto-js (AES-128-ECB and RC4 decryption)
- **UI Framework**: React 18 + Tailwind CSS
- **Build Tool**: Plasmo CLI + Webpack

## Core Algorithm

NCM file format decryption involves the following steps:

1. **File Header Verification** - Validates the NCM file magic number `CTENFDAM`
2. **Key Decryption** - Decrypts the main key using AES-128-ECB with CORE_KEY
3. **Metadata Decryption** - Decrypts music metadata using AES-128-ECB with META_KEY
4. **Audio Decryption** - Decrypts audio data using a mask generated by RC4 KSA algorithm

## Project Structure

```
src/
â”œâ”€â”€ popup.tsx                 # Main popup component
â”œâ”€â”€ popup.css                # Stylesheet
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ ncmConverter.ts      # NCM decryption core logic
â””â”€â”€ i18n/
    â”œâ”€â”€ messages.ts          # Multi-language translation texts
    â””â”€â”€ context.tsx          # i18n React Context
```

## Development Guide

### Install Dependencies

```bash
pnpm install
# or
npm install
```

### Development Mode

```bash
pnpm dev
# or
npm run dev
```

Then in Chrome:
1. Go to `chrome://extensions/`
2. Enable "Developer mode"
3. Click "Load unpacked"
4. Select the `build/chrome-mv3-dev` folder

### Build for Production

```bash
pnpm build
# or
npm run build
```

The build output will be in the `build/chrome-mv3-prod` folder.

## Usage

1. Install this extension on the [Chrome Web Store](https://chromewebstore.google.com/detail/csgo-price-helper/gllpkeapfamjcbkacnbmobfkgnhlfkhf).

   [![Chrome Web Store](readme/get-chrome.png)](https://chromewebstore.google.com/detail/csgo-price-helper/gllpkeapfamjcbkacnbmobfkgnhlfkhf)
2. Click the extension icon to open the conversion window
3. Click "Select File" button to choose a .ncm file
4. Click "Start Convert" button
5. Wait for the conversion to complete, the file will be automatically downloaded

## Internationalization

The project supports multiple languages with Chinese as the default. To add a new language:

1. Edit `src/i18n/messages.ts`
2. Add a new language dictionary in the `messages` object
3. Update the `Language` type to include the new language code

## License

MIT
